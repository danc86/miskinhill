<?xml version="1.0" encoding="UTF-8" ?>
<modsCollection xmlns="http://www.loc.gov/mods/v3"
                xmlns:py="http://genshi.edgewall.org/">

<?python
from representations import MODSRepresentation
?>

<mods py:with="article = node; issue = article['dc:isPartOf']; journal = issue['mhs:isIssueOf']">
    <titleInfo>
        <!-- XXX nonSort -->
        <title>${Markup(article['dc:title']).striptags()}</title>
        <!-- XXX subtitle -->
    </titleInfo>
    <location>
        <url displayLabel="HTML version" access="object in context" usage="primary display">${article.uri}</url>
        <url displayLabel="Original print version" access="raw object">${article.uri}.pdf</url>
    </location>
    <language>
        <languageTerm py:for="lang in journal.getall('dc:language')" type="code" authority="rfc3066">${lang}</languageTerm>
    </language>
    <name type="personal" py:with="author = article['dc:creator']">
        <displayForm>${author['foaf:name']}</displayForm>
        <namePart type="given">${author['foaf:givenNames']}</namePart>
        <namePart type="family">${author['foaf:surname']}</namePart>
        <role>
            <roleTerm authority="marcrelator" type="text">author</roleTerm>
        </role>
    </name>
    <typeOfResource>text</typeOfResource>
    <genre authority="marcgt">periodical</genre>
    <physicalDescription>
        <form authority="marcform">electronic</form>
        <!-- XXX this is lame (just look at Content-Type response header!), but is required by Aquifer guidelines?? -->
        <internetMediaType>text/html</internetMediaType>
        <internetMediaType>application/pdf</internetMediaType>
    </physicalDescription>
    <relatedItem type="host">
        ${MODSRepresentation(req, journal).generate().select('.//mods/*')}
        <part>
            <date encoding="w3cdtf">${issue['dc:coverage']}</date>
            <detail type="volume"><number>${issue['mhs:volume']}</number></detail>
            <detail type="issue"><number>${issue['mhs:issueNumber']}</number></detail>
            <extent unit="page">
                <start>${article['mhs:startPage']}</start>
                <end>${article['mhs:endPage']}</end>
            </extent>
        </part>
    </relatedItem>
    <identifier type="uri">${article.uri}</identifier>
    <subject py:for="subject in sorted(article.getall('dc:subject'), key=lambda s: s['mhs:label'])" authority="lcsh">
        <topic>${subject['mhs:label']}</topic>
    </subject>
</mods>

</modsCollection>
