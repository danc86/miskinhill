<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      lang="en-AU">
<xi:include href="_commonwrapper.xml" />

<?python
review = node
book = review['mhs:reviews']
issue = review['dc:isPartOf']
journal = issue['mhs:isIssueOf']
?>

<head>
    <title>Review of ${Markup(book['dc:title']).striptags()} - ${journal['dc:title']} Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']}</title>
    <link rel="stylesheet" type="text/css" href="/style/review.css" />
</head>

<body>

${breadcrumbs([('/journals/', 'Journals'), 
               (journal.uri, journal['dc:title']),
               (issue.uri, 'Vol. %s, Issue %s' % (issue['mhs:volume'], issue['mhs:issueNumber']))])}

<h2><em>${book['dc:title']}</em> by ${book['dc:creator']}</h2>

<div class="metabox-container">
    <div class="review-meta metabox">
        <p>Other formats: <a href="${review.uri}.pdf">PDF</a></p>
        <p>Metadata: <a href="${review.uri}.nt">RDF</a></p>
    </div>

    <div class="book-meta metabox">
        <?python
        asin = isbn = None
        for identifier in book.getall('dc:identifier', as_uriref=True):
            if identifier.startswith('urn:asin:'):
                asin = identifier[9:]
            elif identifier.startswith('urn:isbn:'):
                isbn = identifier[9:]
                assert len(isbn) == 13
        ?>
        <p class="publication">Published by ${book['dc:publisher']}, ${book['dc:date']}</p>
        <p class="cover" py:if="asin"><img src="http://images.amazon.com/images/P/${asin}.01.MZZZZZZZ.jpg" /></p>
        <p class="links" py:if="asin or isbn">Find this book online:
            <py:if test="asin"><br /><a href="http://www.amazon.com/dp/${asin}/?tag=mishil-20">Amazon.com</a></py:if>
            <py:if test="isbn">
                <br /><a href="http://openlibrary.org/search?q=isbn_13:${isbn}">Open Library</a>
                <br /><a href="http://www.worldcat.org/search?q=isbn:${isbn}">WorldCat</a>
                <br /><a href="http://www.librarything.com/isbn/${isbn}">LibraryThing</a>
            </py:if>
        </p>
    </div>
</div>

<p py:with="author = review['dc:creator']">
    Reviewed by <a href="${author.uri}">${author['foaf:name']}</a>
</p>

<xi:include href="${review.uri.replace('http://miskinhill.com.au/', '../../../../content/')}.html"><xi:fallback /></xi:include>

</body>
</html>
