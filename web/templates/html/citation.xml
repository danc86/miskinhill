<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      lang="en-AU">
<xi:include href="_commonwrapper.xml" />

<?python
from viewutils import relative_url
import citations
import representations
citation_node = node
citation = citations.Citation.from_markup(citation_node['mhs:citationMarkup'])
article = citation_node['dc:isPartOf']
issue = article['dc:isPartOf']
journal = issue['mhs:isIssueOf']
?>

<head>
    <title>Citation - ${Markup(article['dc:title']).striptags()} - ${journal['dc:title']} Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']}</title><!-- XXX way too long? -->
    <link rel="stylesheet" type="text/css" href="/style/citation.css" />
</head>

<body>

${breadcrumbs([('/journals/', 'Journals'), 
               (relative_url(journal.uri), journal['dc:title']),
               (relative_url(issue.uri), 'Vol. %s, Issue %s' % (issue['mhs:volume'], issue['mhs:issueNumber'])), 
               (relative_url(article.uri), article['dc:title'])])}

<h2>Citation in ${article['dc:title']}<abbr class="unapi-id" title="${citation_node.uri}" /></h2>

<div py:if="citation.genre == 'book'">${representations.HTMLRepresentation(req, citation_node['mhs:cites']).generate().select('//div[@class="bookinfo"]')}</div>

<div>${citation.coins(as_markup=True)}</div>

<p>Cited as:</p>
<blockquote><p>${citation_node['mhs:citationMarkup']}</p></blockquote>

</body>
</html>
