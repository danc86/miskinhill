<?xml version="1.0" encoding="UTF-8" ?>
<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:py="http://genshi.edgewall.org/"
     xmlns:xi="http://www.w3.org/2001/XInclude">

<div py:def="articleinfo(article)" class="articleinfo">

<?python
import urllib
import viewutils
issue = article['dc:isPartOf']
journal = issue['mhs:isIssueOf']
issn = journal.identifier('urn:issn:')
?>

<py:choose>
    <py:when test="issue.getone('mhs:coverThumbnail', as_uriref=True, default=None)">
        <p class="cover"><img src="${issue.getone('mhs:coverThumbnail', as_uriref=True)}" alt="" /></p>
    </py:when>
</py:choose>

<div class="beside">
    <p class="main" py:with="title = article.getone('dc:title', None); authors = article.getall('dc:creator')">
        <py:if test="title">
            ‘<a py:strip="not article.getone('mhs:availableFrom', default=None, as_uriref=True)" href="${article.getone('mhs:availableFrom', as_uriref=True)}">${title}</a>’<br />
            <py:if test="authors">by ${Markup(', ').join(viewutils.linked_author(a) for a in authors)}</py:if>
        </py:if>
    </p>

    <p class="issue" py:with="volume = issue.getone('mhs:volume', default=None);
                              issue_number = issue.getone('mhs:issueNumber', default=None);
                              coverage = issue.getone('dc:coverage', default=None)">
        Published in
        <a py:strip="not journal.getone('mhs:availableFrom', default=None, as_uriref=True)" href="${journal.getone('mhs:availableFrom', as_uriref=True)}"><em>${journal['dc:title']}</em></a>
        <a py:strip="not issue.getone('mhs:availableFrom', default=None, as_uriref=True)" href="${issue.getone('mhs:availableFrom', as_uriref=True)}"><py:if test="volume">Vol.&nbsp;${volume}</py:if><py:if test="volume and issue_number">, </py:if><py:if test="issue_number">Issue&nbsp;${issue_number}</py:if>
        <py:if test="coverage">(${coverage})</py:if></a>
        <br />
        <py:if test="issn">ISSN ${issn}</py:if>
    </p>
    <p class="links" py:if="article.getone('dc:title', None)">Find this article online:<br />
        <a href="http://scholar.google.com.au/scholar?q=${urllib.quote(Markup(article['dc:title']).striptags().encode('utf8'), '')}">Google Scholar</a>, 
        <a py:if="issn" href="http://www.worldcat.org/search?q=issn:${'%s-%s' % (issn[0:4], issn[4:])}">WorldCat</a>
    </p>
</div>

</div>

</div>
