<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      lang="en-AU">
<xi:include href="_commonwrapper.xml" />

<?python
from viewutils import parsed_content, striptags, linked_author
import representations
article = node
issue = article['dc:isPartOf']
journal = issue['mhs:isIssueOf']
?>

<head>
    <title>${striptags(article['dc:title'])} - ${journal['dc:title']} Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']}</title>
    <py:for each="r in representations.for_node(node)" py:if="r.format != 'html'">
        ${r(req, node).link()}
    </py:for>
    <link rel="stylesheet" type="text/css" href="/style/article.css" />
    <script type="text/javascript" src="${req.script_name}/script/jquery-1.3.2.js" />
    <script type="text/javascript" src="${req.script_name}/script/jquery.scrollTo-1.4.1.js" />
    <script type="text/javascript" src="${req.script_name}/script/footnote.js" />
    <script type="text/javascript" src="${req.script_name}/script/citation.js" />
</head>

<body>

${breadcrumbs([('/journals/', 'Journals'), 
               (journal.uri, journal['dc:title']),
               (issue.uri, 'Vol. %s, Issue %s' % (issue['mhs:volume'], issue['mhs:issueNumber']))])}

<h2>${article['dc:title']}<abbr class="unapi-id" title="${article.uri}" /></h2>

<div class="metabox-container">
    <div class="article-meta metabox">
        <h4>Article details</h4>
        <p>Published in <a href="${issue.uri}">Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']}</a> of<br /><a href="${journal.uri}"><em>${journal['dc:title']}</em></a></p>
        <p class="other-formats"><a href="${article.uri}.pdf">Original print version</a></p>
        <div class="subjects">
            <p>Subjects:</p>
            <ul py:with="subjects = sorted(article.getall('dc:subject'), key=lambda s: s['mhs:label'])">
                <li py:for="subject in subjects">
                    ${subject['mhs:label'].replace('--', ' &ndash; ')}
                </li>
            </ul>
        </div>
        <p class="metadata-links">Metadata:
            ${Markup(u', ').join(r(req, node).anchor() for r in representations.for_node(node) if r.format != 'html')}
        </p>
    </div>
</div>

<p>
    by ${Markup(', ').join(linked_author(a) for a in article.getall('dc:creator'))}
</p>

${parsed_content(req.content_dir + unicode(article.uri)[24:] + '.html', article.uri)}

</body>
</html>
