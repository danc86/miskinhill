<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      lang="en-AU">
<xi:include href="_commonwrapper.xml" />

<?python
issue = node
journal = issue['mhs:isIssueOf']
?>

<head>
    <title>${journal['dc:title']} Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']}</title>
</head>

<body>

<div class="cover"><img src="${issue.getone('mhs:coverThumbnail', as_uriref=True)}" alt="" /></div>

<h2 class="journal-title"><a href="${journal.uri}">${journal['dc:title']}</a></h2>

<h3 class="issue">Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']} (${issue['dc:coverage']})</h3>

<p class="issue-meta">Published ${issue['mhs:publicationDate'].strftime('%d %B %Y')}</p>

<ul>
    <li py:for="article in sorted(issue.reflexive('dc:isPartOf', type='mhs:Article'), key=lambda a: a['mhs:startPage'])"
        py:with="author = article['dc:creator']">
        <a href="${article.uri}">${article['dc:title']}</a>
        by
        <a href="${author.uri}">${author['foaf:name']}</a>
    </li>
</ul>

<h3>Reviews</h3>
<ul>
    <li py:for="review in issue.reflexive('dc:isPartOf', type='mhs:Review')"
        py:with="author = review['dc:creator']; book = review['mhs:reviews']">
        ${', '.join(book['dc:creator'])}, <em>${book['dc:title']}</em> (reviewed by <a href="${author.uri}">${author['foaf:name']}</a>)
    </li>
</ul>

</body>
</html>
