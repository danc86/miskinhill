<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      lang="en-AU">
<xi:include href="_commonwrapper.xml" />

<?python
import representations
journal = node
publisher = journal['dc:publisher']
?>

<head>
    <title>${journal['dc:title']}</title>
    <py:for each="r in representations.for_node(node)" py:if="r.format != 'html'">
        ${r(req, node).link()}
    </py:for>
</head>

<body>

${breadcrumbs([('/journals/', 'Journals')])}

<h2><em>${journal['dc:title']}</em><abbr class="unapi-id" title="${journal.uri}" /></h2>

<div class="metabox-container">
    ${searchbox(journal)}

    <div class="issue-meta metabox">
        <h4>Journal details</h4>
        <p class="cover">
            <img src="${sorted(journal.reflexive('mhs:isIssueOf'), key=lambda i: i['mhs:publicationDate'], reverse=True)[0].getone('mhs:coverThumbnail', as_uriref=True).uri}" alt="" />
        </p>
        <p class="publisher">Published by <a href="${publisher.getone('foaf:homepage', as_uriref=True).uri}">${publisher['foaf:name']}</a></p>
        <p class="issn">ISSN ${journal.identifier('urn:issn:')}</p>
        <p>Metadata:
            ${Markup(u', ').join(r(req, node).anchor() for r in representations.for_node(node) if r.format != 'html')}
        </p>
    </div>
</div>

<h3>Issues available online</h3>
<ul>
    <li py:for="issue in sorted((i for i in journal.reflexive('mhs:isIssueOf') if unicode(i.uri).startswith('http://miskinhill.com.au/journals/')), key=lambda i: i['mhs:publicationDate'], reverse=True)">
        <a href="${issue.uri}">
            Vol.&nbsp;${issue['mhs:volume']},
            Issue&nbsp;${issue['mhs:issueNumber']}
            (${issue['dc:coverage']})
        </a>
    </li>
</ul>

<h3>About this journal</h3>
<div>${journal['dc:description']}</div>

</body>
</html>
