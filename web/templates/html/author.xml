<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      lang="en-AU">
<xi:include href="_commonwrapper.xml" />

<?python
author = node
articles = [a for a in author.reflexive('dc:creator', type='mhs:Article') if a.uri.startswith('http://miskinhill.com.au/')]
reviews = [r for r in author.reflexive('dc:creator', type='mhs:Review') if a.uri.startswith('http://miskinhill.com.au/')]
?>

<head>
    <title>${author['foaf:name']}</title>
    <link rel="stylesheet" type="text/css" href="/style/author.css" />
</head>

<body>

<h2>${author['foaf:name']}<abbr class="unapi-id" title="${author.uri}" /></h2>

<p py:if="'mhs:biographicalNotes' in author">${author['mhs:biographicalNotes']}</p>

<p py:if="'mhs:isAffiliatedWith' in author">Affiliated with: <a href="${author['mhs:isAffiliatedWith'].uri}">${author['mhs:isAffiliatedWith']['foaf:name']}</a></p>

<py:if test="articles">
    <h3>Articles</h3>
    <ul class="articles">
        <li py:for="article in sorted(articles, key=lambda a: a['dc:isPartOf']['mhs:publicationDate'], reverse=True)"
            py:with="issue = article['dc:isPartOf']; journal = issue['mhs:isIssueOf']">
            <div class="article"><a href="${article.uri}">${article['dc:title']}</a></div>
            <div class="issue">in <a href="${issue.uri}"><em>${journal['dc:title']}</em> Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']} (${issue['dc:coverage']})</a></div>
        </li>
    </ul>
</py:if>

<py:if test="reviews">
    <h3>Reviews</h3>
    <ul class="reviews">
        <li py:for="review in sorted(reviews, key=lambda r: (r['dc:isPartOf']['mhs:publicationDate'], r['mhs:startPage']), reverse=True)"
            py:with="book = review['mhs:reviews']; issue = review['dc:isPartOf']; journal = issue['mhs:isIssueOf']">
            <div class="book"><a href="${review.uri}">${book['dc:creator']}, <em>${book['dc:title']}</em> (${book['dc:date'][:4]})</a></div>
            <div class="issue">in <a href="${issue.uri}"><em>${journal['dc:title']}</em> Vol. ${issue['mhs:volume']}, Issue ${issue['mhs:issueNumber']} (${issue['dc:coverage']})</a></div>
        </li>
    </ul>
</py:if>

</body>
</html>
